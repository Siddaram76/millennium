<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Results</title>

<style>
body{
    font-family: Arial, sans-serif;
    background: powderblue;
    padding:20px;
}
.container{
    max-width:900px;
    margin:auto;
    background:#fff;
    padding:20px;
    border-radius:10px;
    box-shadow:0 0 10px rgba(0,0,0,0.1);
}
h1,h3{text-align:center;color:#4a90e2}
.logo{
    display:block;
    margin:auto;
    max-width:150px;
}
input,button{
    width:100%;
    padding:15px;
    font-size:18px;
    margin-top:15px;
    border-radius:8px;
}
button{
    background:#4a90e2;
    color:white;
    border:none;
    cursor:pointer;
}
button:hover{background:#357abd}
.result-card{
    margin-top:25px;
    padding:20px;
    background:#f9f9f9;
    border-radius:10px;
}
table{
    width:100%;
    border-collapse:collapse;
}
th,td{
    border:1px solid #ccc;
    padding:10px;
}
th{
    background:#4a90e2;
    color:white;
}
.result-summary{
    margin-top:15px;
    background:#4a90e2;
    color:white;
    padding:10px;
    display:flex;
    justify-content:space-between;
    font-weight:bold;
}
footer{text-align:center;margin-top:30px}
</style>
</head>

<body>
<div class="container">

<img src="https://github.com/Siddaram76/millennium/blob/main/logo.jpg?raw=true" class="logo">
<h3>Kalyana Karnataka Education Societyâ€™sÂ®</h3>
<h1>MILLENNIUM COMPOSITE PU COLLEGE, KALABURGI</h1>
<marquee><h2>M E T â€“ 2026</h2></marquee>
<hr>

<h1>Student Results</h1>

<input type="text"
       id="rollInput"
       placeholder="Enter Roll Number"
       oninput="this.value=this.value.replace(/[^0-9]/g,'')"
       onkeypress="if(event.key==='Enter') searchResult()">

<button onclick="searchResult()">Search</button>

<div id="results"></div>

</div>

<script>
const sheetId = '1M4dPi1mx84vOsOF-0-7_jaBfhJ98zosyCFTHaRuq9kA';
const apiKey = 'AIzaSyC-wylWnO4XxBbciUF1FwySQaZNM66j6sg';
const sheetName = 'MET2026';   // ðŸ”´ your sheet tab

let data = [];
let headers = [];

async function fetchData(){
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetName}?key=${apiKey}`;
    const res = await fetch(url);
    const json = await res.json();
    data = json.values;
    headers = data[0].map(h => h.trim());
}

function searchResult(){
    const roll = document.getElementById("rollInput").value.trim();
    const out = document.getElementById("results");

    if(!roll){
        alert("Enter Roll Number");
        return;
    }

    fetchData().then(()=>{
        out.innerHTML = "";

        const rollIndex = headers.indexOf("Roll Number");
        const nameIndex = headers.indexOf("Name");
        const totalIndex = headers.indexOf("Total");
        const percentIndex = headers.indexOf("Percentage");

        const student = data.slice(1).find(row => row[rollIndex] === roll);

        if(!student){
            out.innerHTML = "<b>No result found</b>";
            return;
        }

        let subjectRows = "";
        headers.forEach((head, i)=>{
            if(
                head !== "Name" &&
                head !== "Roll Number" &&
                head !== "Total" &&
                head !== "Percentage"
            ){
                subjectRows += `<tr><td>${head}</td><td>${student[i] || "-"}</td></tr>`;
            }
        });

        out.innerHTML = `
        <div class="result-card">
            <h3>Name: ${student[nameIndex]}</h3>
            <p><b>Roll Number:</b> ${student[rollIndex]}</p>

            <table>
                <tr><th>Subject</th><th>Marks</th></tr>
                ${subjectRows}
            </table>

            <div class="result-summary">
                <div>Total: ${student[totalIndex] || "-"}</div>
                <div>Percentage: ${student[percentIndex] || "-"}%</div>
            </div>
        </div>`;
    });
}
</script>

<footer>
<hr>
<strong>
Developed & Maintained by Siddaram Diggikar<br>
Dept. of Computer Science
</strong>
</footer>

</body>
</html>
